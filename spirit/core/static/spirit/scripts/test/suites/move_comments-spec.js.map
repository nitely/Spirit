{"version":3,"file":"move_comments-spec.js","sources":["move_comments-spec.coffee"],"names":[],"mappings":"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","sourcesContent":["describe \"move_comments plugin tests\", ->\n    show_move_comments = null\n    plugin_move_comments = null\n    MoveComment = null\n\n    beforeEach ->\n        fixtures = do jasmine.getFixtures\n        fixtures.fixturesPath = 'base/test/fixtures/'\n        loadFixtures 'move_comments.html'\n\n        show_move_comments = $('.js-show-move-comments').move_comments {csrfToken: \"foobar\", target: \"/foo/\"}\n        plugin_move_comments = show_move_comments.first().data 'plugin_move_comments'\n        MoveComment = $.fn.move_comments.MoveComment\n\n    it \"doesnt break selector chaining\", ->\n        expect(show_move_comments).toEqual $('.js-show-move-comments')\n        expect(show_move_comments.length).toEqual 1\n\n    it \"shows the move form on click\", ->\n        expect($(\".move-comments\").is \":visible\").toEqual false\n        expect($(\".move-comment-checkbox\").length).toEqual 0\n\n        $('.js-show-move-comments').trigger 'click'\n        expect($(\".move-comments\").is \":visible\").toEqual true\n        expect($(\".move-comment-checkbox\").length).toEqual 2\n\n    it \"prevents the default click behaviour on show move comments\", ->\n        event = {type: 'click', stopPropagation: (->), preventDefault: (->)}\n        stopPropagation = spyOn event, 'stopPropagation'\n        preventDefault = spyOn event, 'preventDefault'\n\n        show_move_comments.first().trigger event\n        expect(stopPropagation).toHaveBeenCalled()\n        expect(preventDefault).toHaveBeenCalled()\n\n    it \"prevents the default click behaviour on submit\", ->\n        event = {type: 'click', stopPropagation: (->), preventDefault: (->)}\n        stopPropagation = spyOn event, 'stopPropagation'\n        preventDefault = spyOn event, 'preventDefault'\n\n        spyOn plugin_move_comments, 'formSubmit'\n        $(\".js-move-comments\").trigger event\n        expect(stopPropagation).toHaveBeenCalled()\n        expect(preventDefault).toHaveBeenCalled()\n\n    it \"submits the form\", ->\n        formSubmit = spyOn plugin_move_comments, 'formSubmit'\n\n        $('.js-show-move-comments').trigger 'click'\n        $( \".js-move-comments\" ).trigger 'click'\n        expect(formSubmit).toHaveBeenCalled()\n        expect($(\"form\").last().attr('action')).toEqual \"/foo/\"\n        expect($(\"form\").last().is \":visible\").toEqual false\n        expect($(\"input[name=csrfmiddlewaretoken]\").val()).toEqual \"foobar\"\n        expect($(\"input[name=topic]\").val()).toEqual \"10\"\n        expect($(\"form\").last().find(\"input[name=comments]\").length).toEqual 2\n"]}